What is the safe withdrawal rate (SWR)? 

Assuming you have E equity invested in S&P 500 index fund when
you start your retirement:  
To cover next year's expenses,
you withdraw  
&emsp;E SWR  
The remaining equity in your S&P 500 index fund is  
&emsp;E - E SWR  

If annual return for year 0 is r<sub>0</sub>, then at the end of year 0,
the equity in S&P 500 index fund becomes  
&emsp;(E - E SWR) (1+r<sub>0</sub>)  
To adjust for year 0's inflation i<sub>0</sub>, now you withdraw  
&emsp;(E - E SWR) (1+i<sub>0</sub>)  
to cover next year's expenses.
The remaining equity in your S&P 500 index fund at the end of year 0 is  
&emsp;e<sub>0</sub> = (E - E SWR) (1+r<sub>0</sub>) - E SWR (1+i<sub>0</sub>)   

If annual return for year 1 is r<sub>1</sub>, at the end of year 1,
the equity in S&P 500 index fund becomes  
&emsp;e<sub>0</sub> (1+r<sub>1</sub>)  
After withdrawal for next year's expenses, the remaining fund is  
&emsp;e<sub>1</sub> = e<sub>0</sub> (1+r<sub>1</sub>) - E SWR (1+i<sub>0</sub>) (1+i<sub>1</sub>)  
And so on.

In general after withdrawal for next year's expenses, the remaining fund
at year n is  
&emsp;e<sub>n</sub> = e<sub>n-1</sub> (1+r<sub>n</sub>) - E SWR (1+i<sub>0</sub>) ... (1+i<sub>n</sub>)  
